<!DOCTYPE html>
<html>

<head>
    <!-- AngularJS library -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <!-- AngularJS route -->
    <script src="//unpkg.com/angular-ui-router@latest/release/angular-ui-router.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- material icons -->
    <link
        href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
        rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/selectize.css">
    <script src="../js/jquery.min.js"></script>
    <script src="../js/selectize.js"></script>
    <script src="../js/index.js"></script>
    <title>Question Drop</title>
</head>

<body ng-app="routerApp" ng-controller="myCtrl">
    <!-- Navbar -->
    <div ng-include="'navbar.html'"></div>

    <!-- Hero section -->
    <section class="hero-area">
        <div class="overlay"></div>
        <span class="stroke-shape stroke-shape-1"></span>
        <span class="stroke-shape stroke-shape-2"></span>
        <span class="stroke-shape stroke-shape-3"></span>
        <span class="stroke-shape stroke-shape-4"></span>
        <span class="stroke-shape stroke-shape-5"></span>
        <span class="stroke-shape stroke-shape-6"></span>
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="hero-content">
                        <h2 class="section-title pb-3 text-white">Share & grow knowledge with us!</h2>
                        <p class="section-desc text-white">Ask questions and get real answers from real people. Whether
                            you’re looking for crossword answers, practical advice or
                            you’ve just come for a chat, get answers to your questions. To get started all you need to
                            do is register.
                        </p>
                        <div class="hero-btn-box py-4">
                            <a href="/askquestion" class="btn theme-btn-white">Ask a Question
                                <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                            </a>
                        </div>
                    </div><!-- end hero-content -->
                </div><!-- end col-lg-9 -->
                <div class="col-lg-4">
                    <div class="hero-list hero-list-bg">
                        <div class="d-flex align-items-center pb-30px">
                            <svg width="26" height="26" class="svg-icon" style="fill:white; margin-right:.5rem;">
                                <path opacity=".5"
                                    d="M4.2 4H22a2 2 0 012 2v11.8a3 3 0 002-2.8V5a3 3 0 00-3-3H7a3 3 0 00-2.8 2z">
                                </path>
                                <path
                                    d="M1 7c0-1.1.9-2 2-2h18a2 2 0 012 2v12a2 2 0 01-2 2h-2v5l-5-5H3a2 2 0 01-2-2V7zm10.6 11.3c.7 0 1.2-.5 1.2-1.2s-.5-1.2-1.2-1.2c-.6 0-1.2.4-1.2 1.2 0 .7.5 1.1 1.2 1.2zm2.2-5.4l1-.9c.3-.4.4-.9.4-1.4 0-1-.3-1.7-1-2.2-.6-.5-1.4-.7-2.4-.7-.8 0-1.4.2-2 .5-.7.5-1 1.4-1 2.8h1.9v-.1c0-.4 0-.7.2-1 .2-.4.5-.6 1-.6s.8.1 1 .4a1.3 1.3 0 010 1.8l-.4.3-1.4 1.3c-.3.4-.4 1-.4 1.6 0 0 0 .2.2.2h1.5c.2 0 .2-.1.2-.2l.1-.7.5-.7.6-.4z">
                                </path>
                            </svg>
                            <p class="fs-15 text-white lh-20">Anybody can ask a question</p>
                        </div>
                        <div class="d-flex align-items-center pb-30px">
                            <span class="material-icons" style="color:white; margin-right: .5rem;">
                                question_answer
                            </span>
                            <p class="fs-15 text-white lh-20">Anybody can answer</p>
                        </div>
                        <div class="d-flex align-items-center">
                            <svg width="26" height="26" class="svg-icon" style="fill:white; margin-right:.5rem;">
                                <path d="M12 .7a2 2 0 013 0l8.5 9.6a1 1 0 01-.7 1.7H4.2a1 1 0 01-.7-1.7L12 .7z"></path>
                                <path opacity=".5"
                                    d="M20.6 16H6.4l7.1 8 7-8zM15 25.3a2 2 0 01-3 0l-8.5-9.6a1 1 0 01.7-1.7h18.6a1 1 0 01.7 1.7L15 25.3z">
                                </path>
                            </svg>
                            <p class="fs-15 text-white lh-20">The best answers are voted up and rise to the top</p>
                        </div>
                    </div>
                </div>
            </div><!-- end row -->
        </div><!-- end container -->
    </section>


    <!-- Question Area -->
    <section class="question-area">
        <div class="container">
            <div class="row">
                <div class="col-lg-2">
                    <div class="card card-item">
                        <div class="card-body">
                            <h3 class="pb-3" style="font-size: 17px; font-weight: 700; color: #000; line-height:25px;">
                                Trending
                                Tags</h3>
                            <div class="divider"><span></span></div>
                            <div class="tags pt-4" ng-repeat="tag in tags">
                                <div class="tag-item">
                                    <a ng-click="tagcall(tag.tag)" class="tag-link tag-link-md">#{{tag.tag}}</a>
                                    <span class="item-multiplier">
                                        <span>×</span>
                                        <span>{{tag.posts.length}}</span>
                                    </span>
                                </div><!-- end tag-item -->
                            </div>
                            <div class="collapse" id="showMoreTags">
                                <div class="tag-item">
                                    <a href="#" class="tag-link tag-link-md">java</a>
                                    <span class="item-multiplier">
                                        <span>×</span>
                                        <span>32924</span>
                                    </span>
                                </div><!-- end tag-item -->
                                <div class="tag-item">
                                    <a href="#" class="tag-link tag-link-md">swift</a>
                                    <span class="item-multiplier">
                                        <span>×</span>
                                        <span>32924</span>
                                    </span>
                                </div><!-- end tag-item -->
                                <div class="tag-item">
                                    <a href="#" class="tag-link tag-link-md">html</a>
                                    <span class="item-multiplier">
                                        <span>×</span>
                                        <span>32924</span>
                                    </span>
                                </div><!-- end tag-item -->
                                <div class="tag-item">
                                    <a href="#" class="tag-link tag-link-md">angular</a>
                                    <span class="item-multiplier">
                                        <span>×</span>
                                        <span>32924</span>
                                    </span>
                                </div><!-- end tag-item -->
                            </div><!-- end collapse -->
                            <a class="collapse-btn" style="font-size: 13px;" data-bs-toggle="collapse"
                                href="#showMoreTags" role="button" aria-expanded="false" aria-controls="showMoreTags">
                                <span class="collapse-btn-hide">Show more<i class="fa fa-angle-down"
                                        style="font-size: 11px; margin-left: 0.25rem;" aria-hidden="true"></i></span>
                                <span class="collapse-btn-show">Show less<i class="fa fa-angle-up"
                                        style="font-size: 11px; margin-left: .25rem;" aria-hidden="true"></i></span>
                            </a>
                        </div>
                    </div><!-- end card -->

                </div><!-- end col-lg-2 -->
                <div class="col-lg-7">

                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="questions" role="tabpanel"
                            aria-labelledby="questions-tab">
                            <div class="filters d-flex align-items-center justify-content-between">
                                <h3 style="font-weight: 600;font-size: 17px;color: #0d233e;    margin: 0;">All Questions
                                </h3>

                            </div>
                            <!-- end filters -->

                            <div ng-show="auth">
                                <h4> Please <a href="/login">Login</a> or <a href="../views/signup.html">signup</a> to
                                    view </h4>
                            </div>

                            <div ng-show="showMe">

                                <div class="shadow-sm p-3 mb-5 bg-body rounded" ng-repeat="name in names">
                                    <div class="media-body">
                                        <h5><a>{{$index+1}}.
                                                {{name.body |
                                                uppercase}}</a></h5>
                                        <small class="meta">
                                            <span class="pr-1">{{name.date}}</span>
                                            <a href="user-profile.html" class="author">
                                                {{name.userid}}</a>
                                        </small>
                                        <div class="tags">
                                            <span ng-repeat="tag in name.tags">
                                                <a href="/tags/{{tag}}" class="tag-link">{{tag}}</a>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="menu">
                                        <button ng-click="like()" id="likebtn" name="{{name.postid}}" type="button"
                                            class="btn btn-light"> <span id="CountLike">{{name.likes.length}}</span>
                                            Like</button>
                                        <button
                                            style="display: inline; flex-direction: column; width: 108px; height: 38px; box-sizing: border-box;"
                                            type="button" class="btn btn-light cmtbtn">
                                            <div class="cmt" style="position: absolute;">Read More</div>
                                            <div style="z-index: 9;position: relative;display: none;top: 50px;left: -100px;width: 712px;height: auto;"
                                                class="comments">
                                                <div class="shadow-none p-3 mb-5 bg-light rounded">
                                                    <span
                                                        style="font-size: 15px; text-shadow: 20px; font-weight: 200;"></span>
                                                    <br>
                                                    <div style="display: flex;justify-content: flex-start;"
                                                        ng-repeat="cmt in name.comments">
                                                        </hr> <br>
                                                        <h4>{{cmt.userid}}:</h4>
                                                        <h4>{{cmt.body}}</h4>
                                                    </div>
                                                </div>
                                            </div>
                                        </button>
                                        <button type="button" class="btn btn-light" >Share</button>
                                        <button type="button" class="btn btn-light">
                                            <form>
                                                Reply
                                                <input type="hidden" ng-model="reply.postid=name.postid">
                                                <input type="text" style="border: none;" ng-model="reply.body">
                                                <input ng-click='reply_post(reply)' type="submit"
                                                    style="border: none;background-color: aliceblue;margin: 2px 5px;padding: 1px 5px;"
                                                    value="Post">
                                            </form>
                                            <!-- </div> -->
                                        </button>
                                    </div>
                                </div>
                            </div>


                            <div class="question-main-bar">
                                <div class="questions-snippet">
                                    <div class="d-flex media-card media--card align-items-center"
                                        ng-repeat="name in firstName track by $index">
                                        <div class="votes">
                                            <div class="vote-block d-flex align-items-center justify-content-between"
                                                title="Votes">
                                                <span class="vote-counts">0</span>
                                                <span class="vote-icon"></span>
                                            </div>
                                            <div class="answer-block d-flex align-items-center justify-content-between"
                                                title="Answers">
                                                <span class="vote-counts">0</span>
                                                <span class="answer-icon"></span>
                                            </div>
                                        </div>
                                        <div class="media-body">
                                            <h5><a ng-click="askquestion(name.postid)">{{$index+1}}.
                                                    {{name.body |
                                                    uppercase}}</a></h5>
                                            <small class="meta">
                                                <span class="pr-1">{{name.date}}</span>
                                                <a href="user-profile.html" class="author">
                                                    {{name.userid}}</a>
                                            </small>
                                            <div class="tags">
                                                <span ng-repeat="tag in name.tags">
                                                    <a ng-click="tagcall(tag)" class="tag-link">{{tag}}</a>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <!--end media -->
                                </div>
                                <!--end question snippats-->

                            </div>
                            <!-- end Question bar -->
                        </div>
                    </div>
                </div><!-- end col-lg-7 -->

                <!--end col-lg-3-->
            </div><!-- end row -->
        </div><!-- end container -->
    </section>
    <!-- end section -->
    <section class="get-started-area">
        <div class="container">
            <div class="text-center">
                <h2 class="section-title">Question Drop Q&amp;A communities are different. <br> Here's how</h2>
            </div>
            <div class="row" style="padding-top:50px;">
                <div class="col-lg-4 responsive-column-half">
                    <div class="card card-item hover-y text-center">
                        <div class="card-body">
                            <img src="images/bubble.png" alt="bubble">
                            <h5 class="card-title pt-4 pb-2">Expert communities.</h5>
                            <p class="card-text">This is just a simple text made for this unique and awesome template,
                                you
                                can easily edit it as you want.</p>
                        </div><!-- end card-body -->
                    </div><!-- end card -->
                </div><!-- end col-lg-4 -->
                <div class="col-lg-4 responsive-column-half">
                    <div class="card card-item hover-y text-center">
                        <div class="card-body">
                            <img src="images/vote.png" alt="vote">
                            <h5 class="card-title pt-4 pb-2">The right answer. Right on top.</h5>
                            <p class="card-text">This is just a simple text made for this unique and awesome template,
                                you
                                can easily edit it as you want.</p>
                        </div><!-- end card-body -->
                    </div><!-- end card -->
                </div><!-- end col-lg-4 -->
                <div class="col-lg-4 responsive-column-half">
                    <div class="card card-item hover-y text-center">
                        <div class="card-body">
                            <img src="images/check.png" alt="check">
                            <h5 class="card-title pt-4 pb-2">Share knowledge. Earn trust.</h5>
                            <p class="card-text">This is just a simple text made for this unique and awesome template,
                                you
                                can easily edit it as you want.</p>
                        </div><!-- end card-body -->
                    </div><!-- end card -->
                </div><!-- end col-lg-4 -->
            </div><!-- end row -->
        </div><!-- end container -->
    </section>
    <!-- end cta area -->

    <div ng-include="'footer.html'"></div>
    <!-- end footer area -->
    <script>
        $("#select-beast").selectize({
            sortField: "text",
        });
        $("#select-limit").selectize({
            sortField: "text",
        });
    </script>
    <script>



        function comments() {
            let button = document.getElementsByClassName("cmtbtn")[0];
            button.addEventListener('click', function () {
                var cmttext = document.getElementsByClassName("cmt")[0];
                var moreText = document.getElementsByClassName("comments")[0];
                if (moreText.style.display === "none") {
                    moreText.style.display = "block";
                    cmttext.innerHTML = "Read Less";
                } else {
                    moreText.style.display = "none";
                    cmttext.innerHTML = "Read More";
                }
            });
        };


        var i = 0;
        var app = angular.module('routerApp', []);
        app.controller('myCtrl', async function ($scope, $http, $window) {


            $scope.like=() =>{
                const btn = document.getElementById("likebtn");
                let CountLike = parseInt(document.getElementById("CountLike").innerHTML);
                console.log(CountLike);
                const pid = btn.name;
                try {
                    fetch(`/like?postid=${pid}`, { method: 'POST' }).then(res => {
                        console.log(res.msg);
                        console.log(res.data);
                        console.log(res.body);
                        console.log(res.body.data);
                        // location.reload();
                    $scope.askquestion(pid);

                    }).catch(e => {
                        console.log(`err found ${e}`);
                    });
                }
                catch (err) {
                    console.log(`err in ${err}`);
                }
            }

            $scope.showMe = false;
            $scope.count = 0;
            $http({
                method: "GET",
                url: "/feedload",

            }).then(function (response) {
                console.log(response.data)
                $scope.firstName = response.data;
                console.log($scope.firstName);
                $scope.ia = response.data.length;
            });


            $scope.reply_post = (reply) => {
                console.log(reply);

                $scope.data = angular.copy(reply);
                console.log($scope.data);
                $http.post('/reply', $scope.data, {
                    // transformRequest: angular.identity,
                    // headers: { 'Content-Type': undefined }
                }).then(function (results) {
                    $scope.askquestion($scope.data.postid);
                    // console.log(results);  
                });
            }


            $scope.askquestion = function (Que) {

                $http({
                    method: "GET",
                    url: 'Question?postid=' + Que,
                }).then(function (response) {
                    if (response.data == false) {
                        $scope.showMe = false;
                        $scope.firstName = null;
                        $scope.auth = true;
                        $scope.names = response.data;
                        console.log(response.data);
                        setTimeout(comments, 1000);

                        // $window.location.href = '/login.html';
                    }
                    else {

                        $scope.names = response.data;
                        $scope.showMe = true;
                        $scope.auth = false;
                        $scope.firstName = null;
                        setTimeout(comments, 1000);
                        console.log(response.data);

                    }

                });
            }

            $scope.tagcall = function (tag) {
                $http({
                    method: "GET",
                    url: "/tags/" + tag,

                }).then(function (response) {
                    console.log(response.data)
                    $scope.firstName = response.data;
                    console.log($scope.firstName);
                    $scope.ia = response.data.length;
                });
            };

            await $http({
                method: "GET",
                url: "/authentication",
            }).then(function (response2) {
                console.log("f2");
                console.log(response2.data);
                console.log("after f2");
                if (response2.data != 0) {
                    $scope.username = response2.data;
                    $scope.logout = true;
                    $scope.signup = false;
                    $scope.login = false;

                }
                else {
                    $scope.logout = false;
                    $scope.signup = true;
                    $scope.login = true;

                    $scope.username = "Unknown";
                }
            });
            await $http({
                method: "POST",
                url: "/Availabletags",
            }).then(function (response2) {
                console.log("f2");
                console.log(response2.data);
                console.log("after f2");
                if (response2.data != 0) {
                    $scope.tags = response2.data;
                }
                else {
                    $scope.tags = "no tags";
                }
            });


        });

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>

</html>